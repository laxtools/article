# Game data format

계층적 csv 면 대부분 된다. 다른 시도가 잘 안 되면 이를 사용한다. 



## son 

structured object notation. c++ / c / c#의 정형화된 struct와 vector (array) 기반의 데이터 포맷 정의를 구현한다. 

 ### 기본 아이디어

- json 형식에서 매번 서술해야 하는 점 제거 
  - 스키마와 데이터를 분리한 구조 
  - 레코드와 배열 타잎
  - json 파서들에서 수정해서 사용 가능할 듯  

```json
[
{
    value only, 
    3, 
    3.5, 
    [ 3, 1, 3 ], 
    [ { 1.0, fire }, { 2.0, cancel} ]
}, 
...
]
```

json과 유사하지만 map을 제거. 레코드와 배열만 있다. 레코드와 배열은 타잎이고 각 타잎은 다른 타잎을 값으로 가질 수 있다. 배열은 같은 타잎만 갖는다. 

스키마도 같은 형식으로 지정한다. 문자열도 쉼표 이외에는 모드 그냥 적을 수 있다. 

enum의 처리가 필요하다. 구조의 하나로 스키마로 정의한다. 스키마 체계도 중요하다. 

### 파싱 

json 파서를 수정하거나 spirit 기반으로 작성한다. 코드 생성기를 갖추고 로딩을 각 언어의 구조로 읽을 수 있게 한다. 바이너리로 변환 가능하게 한다. 바이너리 변환과 로딩은 serialize / deserialize 과정이다. 

### 편집

이 부분이 가장 어렵다. 트리 형태가 적합하다. 편집 중심으로 사용성을 정리해야 한다. 최소한은 카드 형태로 편집하는 것이다. 다른 son 파일의 필드를 참조로 가져올 수 있게 한다. 엑셀처럼 연관된 파일로 만든다. 

엑셀에서 편집 가능하게 만드는 것이 가장 좋다. 그렇게 하려면 행렬로 만들어야 한다. 행렬이 되려면 배열과 레코드를 컬럼화를 시켜야 한다. 최대 길이를 주고 빈 레코드를 null로 채울 수 있게 하면 된다. 

### 스키마 파일 

skill.schema 파일에 구조를 정의한다. 같은 형식으로 정의하면 좋겠다. 

{

   skill_info, 

   [ 

​     { name, string }, 

​     {last name, string}, 

​     {lst, int[]} , 

​     {act, skill[] }  

   ]

}

위의 메타 정의는 레코드로 { record_type, [ fields, field[] ] } } 가 되고 field는 레코드로 이름과 타잎을 갖는다. 같은 형식으로 자기를 정의할 수 있어야 한다. 

### 중간 평가 

일이 너무 많아진다. 파서, 편집기 모두 부담 스럽다. hcsv가 좋을 듯 하다. 



## hcsv 

[c1, c2, c3, c4 [c41, c42, c43], c5, c6, c7[c71[c711, c712, c713], c72[c721, c722, c723], c73 [ c731, c732, c734] ], c8, c9] 

위와 같이 계층적으로 정의된 csv이다.  excel에서 볼 때 일반 csv와 차이는 없다. 스키마에 의해 의미가 결정된다. 타잎에 따라 struct나 배열이 될 수 있다. 각 컬럼은 타잎을 갖는다. 기본 타잎들과 enum 값일 수 있다. enum은 별도 csv 파일에 정의한다. 

하나의 hcsv 파일은 내부에 스키마 정의를 갖고 있다. 간단하고 강력하며 기존 툴들을 활용할 수 있다. 전체는 struct이고 내부에 배열과 struct를 가진다. son과 거의 유사한 기능을 제공할 수 있으며 다른 hcsv의 필드 참조 타잎으로 유효성 체크와 손쉬운 편집 기능을 제공할 수 있다. 

이 방향으로 생각하고 정리해서 만든다. 당분간은 이 쪽으로 충분할 것 같다. 



## json again 

binary 형식으로 최종 로딩 및 처리. 중간 형식을 자유롭게 편집할 수 있는 에디터와 스키마 개발. 어떤가? 에디터는 javascript와 web 기반 UI로 개발하여 자유롭게 변경 가능하도록 한다.

json은 이제 다 좋은데 에디터가 문제이다. json 형식을 게임 개발자들에게 맞춰서 쉽게 편집 가능하게 하려면 어떻게 해야 할까? 일단, 스키마는 있어야 한다. xslt와 같은 기능도 있으면 좋을 듯. 

celtx가 어떻게 동작하는 지 보는 것도 좋겠다. 



## 자료

https://github.com/npruehs/tome-editor

- 게임 데이터 에디터로 검색 
- Qt에서 작성한 게임 데이터 편집기 
- 편집 후 export 방식 
- validation 기능을 내장 

https://www.celtx.com/gem/index.html

- 게임 디자인 솔루션 

















