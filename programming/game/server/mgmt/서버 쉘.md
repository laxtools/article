# 서버 쉘

원격으로 접속하여 명령을 실행하는 원격 쉘이다. 당연히 로컬에서도 접속하여 볼 수 있다. json 명령과 응답으로 실행한다. 콘솔 클라이언트와 GUI 클라이언트 두 가지가 있다. 



# 기능 

- 로그 리다이렉션 
  - 로그 레벨 변경	
  - 키워드 필터링 
  - regex support
- 명령 실행 
  - 서버에 명령별 처리기를 구현 
- C# 클라이언트 
  - C# 스크립트 기능 포함 
- 압축과 파일전송
  - 패치 기능 
  - 폴더별 해시 파일



## 로그 리다이렉션 

spdlog의 sink 중 하나를 구현한다. 명령 실행 기능을 구현하고 진행한다.



## C# 콘솔 

이걸 제일 먼저 구현한다. powershell과 유사하나 완전히 다르다. 콘솔 명령어 실행이 일부 가능하게 한다. 

json이 입력으로는 불편하다.  기존의 command line 형태를 사용하고 필요하면 쓸 수 있게 한다. 



## 패치 

패치 기능은 SVN과 같은 도구를 생각할 수도 있다. 하지만 실제 서비스를 해보면 SVN이 갱신을 못 해줄 때가 있다. 하나 구현해도 괜찮을 듯 하다. 단지, 시간이 문제이다. 일단 압축 전송만 해서 전체 업데이트를 해본다. 폴더 별 전체 파일에 대한 해시 값만 보관한다. 



# 설계 

- shell_service 
  - 인증
  - 명령 실행
  - 명령 내부 전달 
    - 글로벌 채널로 포스팅
    - 모든 서비스에 전달됨
    - 함수로 override 해서 각자 명령 처리
  - 발급된 토큰으로 인증
    - 128 바이트 문자열
    - 인증 레벨
    - 닉넴
      - 활동 파악을 위해 사용
- 콘솔 
  - C# 콘솔 구현 리서치 







# C# 콘솔 구현 리서치 

전통전인 명령어 기반 인터페이스는 구현이 편하고 빠르다. 표시에 제약이 있는데 이를 WPF로 콘솔을 구현하여 명령 결과를 GUI로 표시하여 극복할 수 있다. 텍스트로 빠르게 구현해 보고 괜찮으면 GUI를 입히는 방식은 항상 옳다. jupyter notebook 방식이다. 

- c# colorful console
  - http://colorfulconsole.com/
  - 가독성이 높아지므로 이를 사용 
  - 폰트도 괜찮은 걸로 지정 
  - json 구성 파일 사용 
- 콘솔 만들기 설명
  - http://johnatten.com/2014/09/07/c-building-a-useful-extensible-net-console-application-template-for-development-and-testing/
  - 쉬운 방법이 잘 나와있다. 

- WPF 콘솔
  - https://github.com/dwmkerr/consolecontrol

## WPF 명령 라인 인터페이스 

직접 하나 만드는 게 좋을 듯 하다. 좋은 연습문제이기도 하다. 







