# RPG 게임의 수치와 재화 

RPG 게임은 역할에 따른 관계의 게임이다. 현재 RPG들은 수치와 재화가 장기간 서비스를 하는 기반이 된다. 이를 성장이라고 한다.  인상을 만드는 기능은 미적인 표현을 갖는 월드와 월드 상의 플레이어, NPC들로 이루어진다. 관계는 사람들 간의 관계를 친구, 파티, 길드, 진영을 핵심으로 구현한다. 

RPG의 기능 중 여기서는 수치와 재화와 연관되 타잎들, 이들 타잎 내 알고리즘들, 데이터, 이들을 조합하여 구성하는 시스템, 분산 처리와 클라이언트 동작 제어를 위한 프로토콜을 살핀다. 



# 능력치 (스탯) 

능력치는 Ability로 추상화 된다. 다양한 상태에서 실수를 얻는 함수이다. 대표적인 것들이 HP, MP, 공격력, 방어력 등이 있다. 다양성과 학습의 재미를 위해 다양한 방식으로 기획되고 구현된다. 

이 값들이 있어야 교전 시 데미지 (피해 수치)를 계산할 수 있고 사망이 처리될 수 있다.  스킬 버프 / 디버프 등도 이들 능력치를 기반으로 한다.  



AbilityValue 

- AbilityType

- Increase
- Decrease
- Value



능력치를 아이템, 레벨 등에서 분리하고 파라미터화 하여 별도로 분리해 내는 작업이 필요하다. 개별 능력치 계산을 위한 함수 분리도 있으며 능력치 타잎별 계산 함수를 만들고 타잎에 대한 디스패칭을 한다.  

- 파라미터화를 통한 시스템 분리 
- 디스패칭을 통한 코드 단순화 



컴포넌트와 이를 뒷받침하는 타잎들, 기획 데이터를 묶어서 하나의 컴포넌트로 본다. 능력치는 컴포넌트 수준으로 테스트가 가능하게 한다. 

컴포넌트에 메세지 전송 함수를 넣을 지 선택할 수 있으나 클라이언트 없이 기능 테스트가 가능하도록 하기 위해서 별도 구조에서 처리하는 게 좋을 듯 하다.  메세지 처리기는 명시적인 함수로 분리한다. 메세지 처리기로 기능 테스트를 처리하지 않아도 되도록 한다. 

CompAbility 

- Constructor( Character& c ); 
- UpdateAbiltiyOnEquipItem( const Item& item ); 
- UpdateAbilityOnUnequipItem( ); 
- Calc* 함수들 
  - 값 계산해서 얻기 



AbilityParam이 이벤트로 동작하고 이를 실행하는 기계로 AbilityCalculator를 둔다. 필요에 따라 계산하는 계산식은 함수로 둔다. 이 함수 자체를 데이터로 만들 수 있을까? 

내부에 AbilityCalcultor를 갖고 외부 인터페이스를 제공한다.  다른 컴포넌트를 사용할 수 있는가? 스파게티가 되지 않도록 주의해야 하는데 지킬 수 있을까? 



## 데이터 

enum 값들을 포함하여 외부 편집 데이터는 코드 생성을 통해 가용하게 만들어야 한다.  하나의 게임을 대상으로 능력치 전체를 데이터로 만들 수 있는 방법을 생각해야 한다. 계산까지 식으로 만들 수 있다면 좋다. 





# 레벨 

경험치로 변경된다.  경험치 획득은 다양한 소스에서 얻는다. 주로 몬스터 사망, 퀘스트 (미션 / 업적)를 통한다. 





# 돈 

재화 구매가 가능한 수치이다.  교환이 불가능한 경우도 있다. 







# 아이템 











# 인벤토리 











# 스킬 효과  



## 룬 





## 버프 / 디버프  









# 펫 





# NPC의 스폰 











# 드랍율과 드랍 아이템 













# 관계 

위의 데이터들은 관계에 사용된다.  전투 시 공격력, 관통율이 방어력, 회피율을 만나 데미지로 나온다.  다시 이는 몬스터 사냥 효율을 통해 아이템 획득율을 결정한다. 아이템을 얻으면 상위 아이템일 경우 다시 능력치에 반영된다. 위의 관계는 분석과 시뮬레이션에서 보다 자세하게 살펴야 한다. 

MMORPG를 만들 때 가장 중요한 부분이 위의 수치 관련 변화 시스템이다.  밸런스 기획자라고 부르는 사람들이 주로 담당하게 되는데 제대로 하는 경우를 보지 못 했다. 대체로 단순한 시스템을 만들거나 이미 있는 시스템을 카피해서 일부 변경한다. 그게 현재의 RPG 시스템들이다. 

수치들 전체가 역학 체계를 만든다. 일종의 경제 시스템이나 시장 경제와 많이 다른 공급과 소비의 시스템이다. 생산량을 시스템에서 제어 가능하다. 



## 경제 시스템 

생산(재화의 획득), 거래, 소비의 흐름이 게임 플레이와 사람들 간의 관계에 흥미를 제공할 수 있도록 유지되어야 한다.  







# 프로토콜 

수치와 재화의 변화가 클라이언트에 반영되어야 한다. 변경 시 일부,  원할 때 전부를 전송하는 방식을 주로 사용한다.  특정 부분이나 전체가 전송되기도 한다.  









# 분석과 시뮬레이션 









